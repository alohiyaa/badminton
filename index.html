<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Badminton Player Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .login-container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            padding: 40px;
            max-width: 400px;
            margin: 100px auto;
            text-align: center;
        }
        
        .dashboard {
            display: none;
        }
        
        .header {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .player-name {
            font-size: 2.5em;
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .last-updated {
            color: #666;
            font-size: 0.9em;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-card h3 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.3em;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }
        
        .stat-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #f5f5f5;
        }
        
        .stat-row:last-child {
            border-bottom: none;
        }
        
        .stat-label {
            font-weight: 600;
            color: #555;
        }
        
        .stat-value {
            font-weight: bold;
        }
        
        .positive {
            color: #27ae60;
        }
        
        .negative {
            color: #e74c3c;
        }
        
        .neutral {
            color: #3498db;
        }
        
        .login-form {
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        
        select, input[type="password"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        select:focus, input[type="password"]:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .login-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: transform 0.3s ease;
            width: 100%;
        }
        
        .login-btn:hover {
            transform: translateY(-2px);
        }
        
        .logout-btn {
            background: #e74c3c;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 20px;
        }
        
        .error {
            color: #e74c3c;
            margin-top: 10px;
            font-size: 14px;
        }
        
        .activity-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-left: 10px;
        }
        
        .active {
            background-color: #27ae60;
        }
        
        .inactive {
            background-color: #e74c3c;
        }
        
        .moderate {
            background-color: #f39c12;
        }

        .performance-bar {
            background: #f0f0f0;
            border-radius: 10px;
            height: 8px;
            margin-top: 5px;
            overflow: hidden;
        }

        .performance-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .player-name {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Login Screen -->
        <div id="login" class="login-container">
            <h1 style="color: #667eea; margin-bottom: 30px;">üè∏ Player Login</h1>
            <form class="login-form" onsubmit="login(event)">
                <div class="form-group">
                    <label for="playerSelect">Select Player:</label>
                    <select id="playerSelect" required>
                        <option value="">Choose your name...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="password">Password:</label>
                    <input type="password" id="password" placeholder="Enter password" required>
                </div>
                <button type="submit" class="login-btn">Login</button>
                <div id="error" class="error"></div>
            </form>
            <button type="button" onclick="clearAllPasswords()" class="logout-btn" style="background: #f39c12; margin-top: 10px;">Reset All Saved Passwords</button>
            
        </div>

        <!-- Dashboard Screen -->
        <div id="dashboard" class="dashboard">
            <div class="header">
                <h1 class="player-name" id="playerName"></h1>
                <p class="last-updated">Last Updated: September 07, 2025</p>
                <button class="logout-btn" onclick="logout()">Logout</button>
                <button class="login-btn" onclick="showChangePasswordModal()" style="margin-top: 10px; width: auto;">Change Password</button>
            </div>

            <div class="stats-grid">
                <!-- Financial Overview -->
                <div class="stat-card">
                    <h3>üí∞ Financial Overview</h3>
                    <div class="stat-row">
                        <span class="stat-label">Current Balance:</span>
                        <span class="stat-value" id="balance"></span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Total Paid:</span>
                        <span class="stat-value neutral" id="totalPaid"></span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Total Expense:</span>
                        <span class="stat-value neutral" id="totalExpense"></span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Delay/Pay Status:</span>
                        <span class="stat-value" id="delayPay"></span>
                    </div>
                </div>

                <!-- Activity Status -->
                <div class="stat-card">
                    <h3>üìä Activity Status</h3>
                    <div class="stat-row">
                        <span class="stat-label">Negative Balance Weeks:</span>
                        <span class="stat-value" id="negativeWeeks"></span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Not Played Since:</span>
                        <span class="stat-value" id="notPlayedSince"></span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Longest Weekly Streak:</span>
                        <span class="stat-value positive" id="longestStreak"></span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Current Weekly Streak:</span>
                        <span class="stat-value" id="currentStreak"></span>
                    </div>
                </div>

                <!-- Performance Stats 2025 -->
                <div class="stat-card">
                    <h3>üè∏ 2025 Performance</h3>
                    <div class="stat-row">
                        <span class="stat-label">Days Played:</span>
                        <span class="stat-value positive" id="daysPlayed"></span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Total Hours:</span>
                        <span class="stat-value positive" id="hoursPlayed"></span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Hours (Last 30 days):</span>
                        <span class="stat-value neutral" id="hoursLast30"></span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Calories Burned:</span>
                        <span class="stat-value positive" id="caloriesBurned"></span>
                    </div>
                    <div class="performance-bar">
                        <div class="performance-fill" id="performanceBar" style="background: linear-gradient(90deg, #27ae60, #2ecc71);"></div>
                    </div>
                </div>

                <!-- September 2025 Stats -->
                <div class="stat-card">
                    <h3>üìÖ September 2025</h3>
                    <div class="stat-row">
                        <span class="stat-label">Days Played:</span>
                        <span class="stat-value positive" id="sepDaysPlayed"></span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Hours Played:</span>
                        <span class="stat-value positive" id="sepHoursPlayed"></span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Court Hours:</span>
                        <span class="stat-value neutral" id="sepCourtHours"></span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Calories:</span>
                        <span class="stat-value positive" id="sepCalories"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Password Modal -->
    <div id="passwordModal" style="display: none; position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4);">
        <div class="login-container" style="margin: 100px auto;">
            <h2 id="passwordModalTitle" style="color: #667eea; margin-bottom: 30px;">Set Your Password</h2>
            <form onsubmit="setPassword(event)">
                <div class="form-group">
                    <label for="newPassword">New Password:</label>
                    <input type="password" id="newPassword" placeholder="Enter new password" required>
                </div>
                <div class="form-group">
                    <label for="confirmPassword">Confirm Password:</label>
                    <input type="password" id="confirmPassword" placeholder="Confirm new password" required>
                </div>
                <button type="submit" class="login-btn">Set Password</button>
                <button type="button" class="logout-btn" onclick="closeChangePasswordModal()" style="background: #aaa; margin-top: 10px;">Cancel</button>
                <div id="passwordError" class="error"></div>
            </form>
        </div>

    <script>
        function sha256(s) {
            var chrsz = 8;
            var hexcase = 0;

            function safe_add(x, y) {
                var lsw = (x & 0xFFFF) + (y & 0xFFFF);
                var msw = (x >> 16) + (y >> 16) + (lsw >> 16);
                return (msw << 16) | (lsw & 0xFFFF);
            }

            function S(X, n) {
                return (X >>> n) | (X << (32 - n));
            }

            function R(X, n) {
                return (X >>> n);
            }

            function Ch(x, y, z) {
                return ((x & y) ^ ((~x) & z));
            }

            function Maj(x, y, z) {
                return ((x & y) ^ (x & z) ^ (y & z));
            }

            function Sigma0256(x) {
                return (S(x, 2) ^ S(x, 13) ^ S(x, 22));
            }

            function Sigma1256(x) {
                return (S(x, 6) ^ S(x, 11) ^ S(x, 25));
            }

            function Gamma0256(x) {
                return (S(x, 7) ^ S(x, 18) ^ R(x, 3));
            }

            function Gamma1256(x) {
                return (S(x, 17) ^ S(x, 19) ^ R(x, 10));
            }

            function core_sha256(m, l) {
                var K = new Array(0x428A2F98, 0x71374491, 0xB5C0FBCF, 0xE9B5DBA5, 0x3956C25B, 0x59F111F1, 0x923F82A4, 0xAB1C5ED5, 0xD807AA98, 0x12835B01, 0x243185BE, 0x550C7DC3, 0x72BE5D74, 0x80DEB1FE, 0x9BDC06A7, 0xC19BF174, 0xE49B69C1, 0xEFBE4786, 0xFC19DC6, 0x240CA1CC, 0x2DE92C6F, 0x4A7484AA, 0x5CB0A9DC, 0x76F988DA, 0x983E5152, 0xA831C66D, 0xB00327C8, 0xBF597FC7, 0xC6E00BF3, 0xD5A79147, 0x6CA6351, 0x14292967, 0x27B70A85, 0x2E1B2138, 0x4D2C6DFC, 0x53380D13, 0x650A7354, 0x766A0ABB, 0x81C2C92E, 0x92722C85, 0xA2BFE8A1, 0xA81A664B, 0xC24B8B70, 0xC76C51A3, 0xD192E819, 0xD6990624, 0xF40E3585, 0x106AA070, 0x19A4C116, 0x1E376C08, 0x2748774C, 0x34B0BCB5, 0x391C0CB3, 0x4ED8AA4A, 0x5B9CCA4F, 0x682E6FF3, 0x748F82EE, 0x78A5636F, 0x84C87814, 0x8CC70208, 0x90BEFFFA, 0xA4506CEB, 0xBEF9A3F7, 0xC67178F2);
                var HASH = new Array(0x6A09E667, 0xBB67AE85, 0x3C6EF372, 0xA54FF53A, 0x510E527F, 0x9B05688C, 0x1F83D9AB, 0x5BE0CD19);
                var W = new Array(64);
                var a, b, c, d, e, f, g, h, i, j;
                var T1, T2;
                m[l >> 5] |= 0x80 << (24 - l % 32);
                m[((l + 64 >> 9) << 4) + 15] = l;
                for (var i = 0; i < m.length; i += 16) {
                    a = HASH[0];
                    b = HASH[1];
                    c = HASH[2];
                    d = HASH[3];
                    e = HASH[4];
                    f = HASH[5];
                    g = HASH[6];
                    h = HASH[7];
                    for (var j = 0; j < 64; j++) {
                        if (j < 16) W[j] = m[j + i];
                        else W[j] = safe_add(safe_add(safe_add(Gamma1256(W[j - 2]), W[j - 7]), Gamma0256(W[j - 15])), W[j - 16]);
                        T1 = safe_add(safe_add(safe_add(safe_add(h, Sigma1256(e)), Ch(e, f, g)), K[j]), W[j]);
                        T2 = safe_add(Sigma0256(a), Maj(a, b, c));
                        h = g;
                        g = f;
                        f = e;
                        e = safe_add(d, T1);
                        d = c;
                        c = b;
                        b = a;
                        a = safe_add(T1, T2);
                    }
                    HASH[0] = safe_add(a, HASH[0]);
                    HASH[1] = safe_add(b, HASH[1]);
                    HASH[2] = safe_add(c, HASH[2]);
                    HASH[3] = safe_add(d, HASH[3]);
                    HASH[4] = safe_add(e, HASH[4]);
                    HASH[5] = safe_add(f, HASH[5]);
                    HASH[6] = safe_add(g, HASH[6]);
                    HASH[7] = safe_add(h, HASH[7]);
                }
                return HASH;
            }

            function str2binb(str) {
                var bin = Array();
                var mask = (1 << chrsz) - 1;
                for (var i = 0; i < str.length * chrsz; i += chrsz)
                bin[i >> 5] |= (str.charCodeAt(i / chrsz) & mask) << (24 - i % 32);
                return bin;
            }

            function Utf8Encode(string) {
                string = string.replace(/\r\n/g, "\n");
                var utftext = "";
                for (var n = 0; n < string.length; n++) {
                    var c = string.charCodeAt(n);
                    if (c < 128) {
                        utftext += String.fromCharCode(c);
                    } else if ((c > 127) && (c < 2048)) {
                        utftext += String.fromCharCode((c >> 6) | 192);
                        utftext += String.fromCharCode((c & 63) | 128);
                    } else {
                        utftext += String.fromCharCode((c >> 12) | 224);
                        utftext += String.fromCharCode(((c >> 6) & 63) | 128);
                        utftext += String.fromCharCode((c & 63) | 128);
                    }
                }
                return utftext;
            }

            function binb2hex(binarray) {
                var hex_tab = hexcase ? "0123456789ABCDEF" : "0123456789abcdef";
                var str = "";
                for (var i = 0; i < binarray.length * 4; i++) {
                    str += hex_tab.charAt((binarray[i >> 2] >> ((3 - i % 4) * 8 + 4)) & 0xF) + hex_tab.charAt((binarray[i >> 2] >> ((3 - i % 4) * 8)) & 0xF);
                }
                return str;
            }
            s = Utf8Encode(s);
            return binb2hex(core_sha256(str2binb(s), s.length * chrsz));
        }

        const initialPasswords = {
            'Tanvir': 'tanvir123', 'Abhishek': 'abhishek123', 'Sumesh': 'sumesh123',
            'Varun': 'varun123', 'Sanjeev': 'sanjeev123', 'Ritesh': 'ritesh123',
            'Satish': 'satish123', 'Harsh': 'harsh123', 'Dushi': 'dushi123',
            'Gaurav': 'gaurav123', 'Vipul': 'vipul123', 'Mohit': 'mohit123',
            'Mahadevan': 'mahadevan123', 'Anuj': 'anuj123', 'Montu': 'montu123',
            'Shonam': 'shonam123', 'Sarthak': 'sarthak123', 'Upkar Sir': 'upkarsir123',
            'Akhil': 'akhil123', 'Saurabh': 'saurabh123'
        };

        const playerData = {
            'Tanvir': {
                balance: 'AED 22', totalPaid: 'AED 10,788', totalExpense: 'AED 10,766', delayPay: 'AED 0',
                negativeWeeks: 0, notPlayedSince: '-', longestStreak: 33, currentStreak: 33,
                daysPlayed: '80/88', hoursPlayed: 155, hoursLast30: 22, caloriesBurned: '67616',
                sepDaysPlayed: '3/3', sepHoursPlayed: 6, sepCourtHours: '5.2', sepCalories: '2652'
            },
            'Abhishek': {
                balance: 'AED 152', totalPaid: 'AED 11,195', totalExpense: 'AED 11,044', delayPay: 'AED 0',
                negativeWeeks: 0, notPlayedSince: '-', longestStreak: 26, currentStreak: 2,
                daysPlayed: '69/88', hoursPlayed: 133, hoursLast30: 14, caloriesBurned: '55179',
                sepDaysPlayed: '3/3', sepHoursPlayed: 6, sepCourtHours: '5.2', sepCalories: '2532'
            },
            'Sumesh': {
                balance: 'AED (89)', totalPaid: 'AED 10,174', totalExpense: 'AED 10,263', delayPay: 'AED 0',
                negativeWeeks: 1, notPlayedSince: '-', longestStreak: 28, currentStreak: 11,
                daysPlayed: '62/88', hoursPlayed: 123, hoursLast30: 22, caloriesBurned: '52849',
                sepDaysPlayed: '3/3', sepHoursPlayed: 6, sepCourtHours: '5.2', sepCalories: '2616'
            },
            'Varun': {
                balance: 'AED 234', totalPaid: 'AED 10,730', totalExpense: 'AED 10,496', delayPay: 'AED 0',
                negativeWeeks: 0, notPlayedSince: '-', longestStreak: 18, currentStreak: 1,
                daysPlayed: '69/88', hoursPlayed: 131, hoursLast30: 10, caloriesBurned: '55668',
                sepDaysPlayed: '3/3', sepHoursPlayed: 6, sepCourtHours: '5.2', sepCalories: '2626'
            },
            'Sanjeev': {
                balance: 'AED 31', totalPaid: 'AED 8,979', totalExpense: 'AED 8,947', delayPay: 'AED 0',
                negativeWeeks: 0, notPlayedSince: '-', longestStreak: 14, currentStreak: 5,
                daysPlayed: '57/88', hoursPlayed: 114, hoursLast30: 20, caloriesBurned: '48284',
                sepDaysPlayed: '3/3', sepHoursPlayed: 6, sepCourtHours: '5.2', sepCalories: '2600'
            },
            'Ritesh': {
                balance: 'AED 52', totalPaid: 'AED 9,119', totalExpense: 'AED 9,067', delayPay: 'AED 0',
                negativeWeeks: 0, notPlayedSince: '-', longestStreak: 35, currentStreak: 6,
                daysPlayed: '63/88', hoursPlayed: 126, hoursLast30: 22, caloriesBurned: '54317',
                sepDaysPlayed: '3/3', sepHoursPlayed: 6, sepCourtHours: '5.2', sepCalories: '2636'
            },
            'Satish': {
                balance: 'AED 134', totalPaid: 'AED 8,429', totalExpense: 'AED 8,295', delayPay: 'AED 0',
                negativeWeeks: 0, notPlayedSince: '-', longestStreak: 14, currentStreak: 6,
                daysPlayed: '68/88', hoursPlayed: 130, hoursLast30: 22, caloriesBurned: '55025',
                sepDaysPlayed: '3/3', sepHoursPlayed: 6, sepCourtHours: '5.2', sepCalories: '2579'
            },
            'Harsh': {
                balance: 'AED 343', totalPaid: 'AED 6,475', totalExpense: 'AED 6,133', delayPay: 'AED 0',
                negativeWeeks: 0, notPlayedSince: '0', longestStreak: 14, currentStreak: 2,
                daysPlayed: '42/88', hoursPlayed: 76, hoursLast30: 6, caloriesBurned: '32109',
                sepDaysPlayed: '2/3', sepHoursPlayed: 4, sepCourtHours: '3.6', sepCalories: '1782'
            },
            'Dushi': {
                balance: 'AED 68', totalPaid: 'AED 5,308', totalExpense: 'AED 5,240', delayPay: 'AED 0',
                negativeWeeks: 0, notPlayedSince: '3', longestStreak: 17, currentStreak: 0,
                daysPlayed: '47/88', hoursPlayed: 92, hoursLast30: 8, caloriesBurned: '39486',
                sepDaysPlayed: '0/3', sepHoursPlayed: 0, sepCourtHours: '0.0', sepCalories: '0'
            },
            'Gaurav': {
                balance: 'AED 7', totalPaid: 'AED 4,031', totalExpense: 'AED 4,024', delayPay: 'AED 0',
                negativeWeeks: 0, notPlayedSince: '3', longestStreak: 10, currentStreak: 0,
                daysPlayed: '26/88', hoursPlayed: 52, hoursLast30: 2, caloriesBurned: '22188',
                sepDaysPlayed: '0/3', sepHoursPlayed: 0, sepCourtHours: '0.0', sepCalories: '0'
            },
            'Vipul': {
                balance: 'AED 32', totalPaid: 'AED 4,340', totalExpense: 'AED 4,308', delayPay: 'AED 0',
                negativeWeeks: 0, notPlayedSince: '11', longestStreak: 7, currentStreak: 0,
                daysPlayed: '33/88', hoursPlayed: 61, hoursLast30: 0, caloriesBurned: '24633',
                sepDaysPlayed: '0/3', sepHoursPlayed: 0, sepCourtHours: '0.0', sepCalories: '0'
            },
            'Mohit': {
                balance: 'AED 654', totalPaid: 'AED 3,830', totalExpense: 'AED 3,176', delayPay: 'AED 0',
                negativeWeeks: 0, notPlayedSince: '2', longestStreak: 11, currentStreak: 0,
                daysPlayed: '48/88', hoursPlayed: 96, hoursLast30: 8, caloriesBurned: '39786',
                sepDaysPlayed: '0/3', sepHoursPlayed: 0, sepCourtHours: '0.0', sepCalories: '0'
            },
            'Mahadevan': {
                balance: 'AED 76', totalPaid: 'AED 3,105', totalExpense: 'AED 3,029', delayPay: 'AED 0',
                negativeWeeks: 0, notPlayedSince: '1', longestStreak: 16, currentStreak: 12,
                daysPlayed: '55/88', hoursPlayed: 107, hoursLast30: 16, caloriesBurned: '45047',
                sepDaysPlayed: '0/3', sepHoursPlayed: 0, sepCourtHours: '0.0', sepCalories: '0'
            },
            'Anuj': {
                balance: 'AED 40', totalPaid: 'AED 2,748', totalExpense: 'AED 2,708', delayPay: 'AED 0',
                negativeWeeks: 0, notPlayedSince: '0', longestStreak: 12, currentStreak: 8,
                daysPlayed: '28/88', hoursPlayed: 56, hoursLast30: 10, caloriesBurned: '23862',
                sepDaysPlayed: '1/3', sepHoursPlayed: 2, sepCourtHours: '2.0', sepCalories: '1006'
            },
            'Montu': {
                balance: 'AED 0', totalPaid: 'AED 2,099', totalExpense: 'AED 2,099', delayPay: 'AED 0',
                negativeWeeks: 0, notPlayedSince: '5', longestStreak: 9, currentStreak: 0,
                daysPlayed: '4/88', hoursPlayed: 5, hoursLast30: 0, caloriesBurned: '2136',
                sepDaysPlayed: '0/3', sepHoursPlayed: 0, sepCourtHours: '0.0', sepCalories: '0'
            },
            'Shonam': {
                balance: 'AED (79)', totalPaid: 'AED 1,302', totalExpense: 'AED 1,381', delayPay: 'AED 0',
                negativeWeeks: 1, notPlayedSince: '-', longestStreak: 11, currentStreak: 2,
                daysPlayed: '26/88', hoursPlayed: 47, hoursLast30: 8, caloriesBurned: '20088',
                sepDaysPlayed: '2/3', sepHoursPlayed: 4, sepCourtHours: '3.6', sepCalories: '1782'
            },
            'Sarthak': {
                balance: 'AED 670', totalPaid: 'AED 1,875', totalExpense: 'AED 1,205', delayPay: 'AED 0',
                negativeWeeks: 0, notPlayedSince: '-', longestStreak: 12, currentStreak: 12,
                daysPlayed: '18/88', hoursPlayed: 36, hoursLast30: 20, caloriesBurned: '15773',
                sepDaysPlayed: '3/3', sepHoursPlayed: 6, sepCourtHours: '5.2', sepCalories: '2584'
            },
            'Upkar Sir': {
                balance: 'AED (140)', totalPaid: 'AED 552', totalExpense: 'AED 642', delayPay: 'AED 50',
                negativeWeeks: 5, notPlayedSince: '3', longestStreak: 8, currentStreak: 0,
                daysPlayed: '4/88', hoursPlayed: 5, hoursLast30: 3, caloriesBurned: '2204',
                sepDaysPlayed: '0/3', sepHoursPlayed: 0, sepCourtHours: '0.0', sepCalories: '0'
            },
            'Akhil': {
                balance: 'AED 0', totalPaid: 'AED 213', totalExpense: 'AED 213', delayPay: 'AED 0',
                negativeWeeks: 0, notPlayedSince: '5', longestStreak: 4, currentStreak: 0,
                daysPlayed: '4/88', hoursPlayed: 8, hoursLast30: 0, caloriesBurned: '3397',
                sepDaysPlayed: '0/3', sepHoursPlayed: 0, sepCourtHours: '0.0', sepCalories: '0'
            },
            'Saurabh': {
                balance: 'AED 0', totalPaid: 'AED 127', totalExpense: 'AED 126', delayPay: 'AED 0',
                negativeWeeks: 1, notPlayedSince: '2', longestStreak: 2, currentStreak: 0,
                daysPlayed: '2/88', hoursPlayed: 4, hoursLast30: 4, caloriesBurned: '1870',
                sepDaysPlayed: '0/3', sepHoursPlayed: 0, sepCourtHours: '0.0', sepCalories: '0'
            }
        };

        let currentPlayer = null;

        function populatePlayerDropdown() {
            const select = document.getElementById('playerSelect');
            Object.keys(playerData).sort().forEach(player => {
                const option = document.createElement('option');
                option.value = player;
                option.textContent = player;
                select.appendChild(option);
            });
        }

        function login(event) {
            event.preventDefault();
            const player = document.getElementById('playerSelect').value;
            const password = document.getElementById('password').value;
            const errorDiv = document.getElementById('error');
            errorDiv.textContent = '';

            if (!player) {
                errorDiv.textContent = 'Please select a player!';
                return;
            }

            const passwordHash = localStorage.getItem('password_' + player);

            if (passwordHash) {
                // User has a password set
                if (sha256(password) === passwordHash) {
                    showDashboard(player);
                } else {
                    errorDiv.textContent = 'Invalid password!';
                }
            } else {
                // First time login, check against initial password
                if (password === initialPasswords[player]) {
                    currentPlayer = player;
                    document.getElementById('passwordModalTitle').textContent = 'Set Your New Password';
                    showChangePasswordModal();
                } else {
                    errorDiv.textContent = 'Invalid initial password!';
                }
            }
        }

        function setPassword(event) {
            event.preventDefault();
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const passwordError = document.getElementById('passwordError');
            passwordError.textContent = '';

            if (newPassword !== confirmPassword) {
                passwordError.textContent = 'Passwords do not match!';
                return;
            }

            if (newPassword.length < 6) {
                passwordError.textContent = 'Password must be at least 6 characters long.';
                return;
            }

            const passwordHash = sha256(newPassword);
            localStorage.setItem('password_' + currentPlayer, passwordHash);
            
            closeChangePasswordModal();
            showDashboard(currentPlayer);
        }

        function showDashboard(player) {
            currentPlayer = player;
            document.getElementById('login').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            populateDashboard(player);
        }

        function showChangePasswordModal() {
            document.getElementById('passwordModal').style.display = 'block';
            document.getElementById('passwordModalTitle').textContent = 'Change Your Password';
            // On change password, current player is already set
        }

        function closeChangePasswordModal() {
            document.getElementById('passwordModal').style.display = 'none';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmPassword').value = '';
            document.getElementById('passwordError').textContent = '';
        }

        function populateDashboard(playerName) {
            const data = playerData[playerName];
            
            document.getElementById('playerName').textContent = playerName;
            
            document.getElementById('balance').textContent = data.balance;
            document.getElementById('balance').className = data.balance.includes('(') ? 'stat-value negative' : 'stat-value positive';
            document.getElementById('totalPaid').textContent = data.totalPaid;
            document.getElementById('totalExpense').textContent = data.totalExpense;
            document.getElementById('delayPay').textContent = data.delayPay;
            
            document.getElementById('negativeWeeks').textContent = data.negativeWeeks;
            document.getElementById('negativeWeeks').className = data.negativeWeeks > 0 ? 'stat-value negative' : 'stat-value positive';
            document.getElementById('notPlayedSince').textContent = data.notPlayedSince === '-' ? 'Active' : data.notPlayedSince + ' weeks';
            document.getElementById('longestStreak').textContent = data.longestStreak + ' weeks';
            document.getElementById('currentStreak').textContent = data.currentStreak + ' weeks';
            document.getElementById('currentStreak').className = data.currentStreak > 0 ? 'stat-value positive' : 'stat-value negative';
            
            document.getElementById('daysPlayed').textContent = data.daysPlayed;
            document.getElementById('hoursPlayed').textContent = data.hoursPlayed + ' hrs';
            document.getElementById('hoursLast30').textContent = data.hoursLast30 + ' hrs';
            document.getElementById('caloriesBurned').textContent = data.caloriesBurned;
            
            document.getElementById('sepDaysPlayed').textContent = data.sepDaysPlayed;
            document.getElementById('sepHoursPlayed').textContent = data.sepHoursPlayed + ' hrs';
            document.getElementById('sepCourtHours').textContent = data.sepCourtHours + ' hrs';
            document.getElementById('sepCalories').textContent = data.sepCalories;

            const hoursProgress = Math.min((data.hoursPlayed / 150) * 100, 100);
            document.getElementById('performanceBar').style.width = hoursProgress + '%';
        }

        function logout() {
            currentPlayer = null;
            document.getElementById('login').style.display = 'block';
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('playerSelect').value = '';
            document.getElementById('password').value = '';
            document.getElementById('error').textContent = '';
            closeChangePasswordModal();
        }

        document.addEventListener('DOMContentLoaded', function() {
            populatePlayerDropdown();
        });

        function clearAllPasswords() {
            if (confirm("Are you sure you want to reset all saved passwords? This will require every player to set a new password on their next login.")) {
                Object.keys(playerData).forEach(player => {
                    localStorage.removeItem('password_' + player);
                });
                alert("All saved passwords have been reset. You can now log in with the initial default passwords.");
                location.reload();
            }
        }
    </script>
</body>
</html>
